<!DOCTYPE html>
<html>
<head>
    <title>BioCalc - RenovaBio Input</title>
    <link rel="stylesheet" href="../static/style.css">
</head>
<body>
    <div style="position: absolute; top: 20px; right: 20px; font-size: 0.9rem;">
        <span>Ol√°, <strong>{{ user.nome }}</strong>!</span>
        | <a href="/historico" style="color: #2e7d32; text-decoration: none;">Meus C√°lculos</a>
        | <a href="/logout" style="color: #c62828; text-decoration: none;">Sair (Logout)</a>
    </div>
    <div class="container container-wide">
        <div class="header-logo">
            <h1>üåø BioCalc - Modo Espelho Planilha</h1>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="form-tabs">
            <button type="button" class="tab-button active" data-tab="tab-geral">1. Defini√ß√µes</button>
            <button type="button" class="tab-button" data-tab="tab-agricola">2. Agr√≠cola</button>
            <button type="button" class="tab-button" data-tab="tab-industrial">3. Industrial</button>
            <button type="button" class="tab-button" data-tab="tab-distribuicao">4. Distribui√ß√£o</button>
            <button type="button" class="tab-button" data-tab="tab-config">5. Configura√ß√£o (Resultados)</button>
        </div>
        
        <form method="POST" action="/calcular" id="biocalc-form">
            
            <div class="tab-content active" id="tab-geral">
                <div class="form-section">
                    <h3>Dados da Biomassa</h3>
                    <div class="field-group">
                        <label class="required">Tipo de Biomassa:</label>
                        <select name="biomassa" required>
                            <option value="">Selecione...</option>
                            {% for biomassa in biomassas %}
                            <option value="{{ biomassa.id }}">{{ biomassa.nome }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="field-group" style="background: #f8f9fa; padding: 15px; border-radius: 5px; border: 1px solid #ddd;">
                        <label>Possui informa√ß√£o sobre o consumo de Biomassa?</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="possui_info_consumo" value="Sim" data-show="input-yield-manual" data-hide="input-yield-padrao"> Sim
                            </label>
                            <label>
                                <input type="radio" name="possui_info_consumo" value="N√£o" checked data-hide="input-yield-manual" data-show="input-yield-padrao"> N√£o
                            </label>
                        </div>
                        <div id="input-yield-manual" style="display: none; margin-top: 15px;">
                            <label>Entrada de biomassa - dado espec√≠fico:</label>
                            <input type="number" name="entrada_especifica_biomassa" step="0.001" min="0">
                            <div class="help-text">kg de biomassa / kg de biocombust√≠vel</div>
                        </div>
                        <div id="input-yield-padrao" style="margin-top: 15px; color: #666;">
                            <em>Ser√° considerado o dado padr√£o.</em>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="tab-agricola">
                <div class="form-section">
                    <h3>Par√¢metros Agr√≠colas</h3>
                    <div class="field-group">
                        <label>Entrada de amido de milho:</label>
                        <input type="number" name="entrada_amido_milho" value="0" step="0.0001" min="0">
                        <div class="help-text">kg / kg de biocombust√≠vel</div>
                    </div>
                    <div class="form-row">
                        <div class="field-group">
                            <label class="required">Estado da produ√ß√£o da Biomassa:</label>
                            <select name="estado_producao" required>
                                <option value="">Selecione...</option>
                                {% for estado in estados %}
                                <option value="{{ estado }}">{{ estado }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="field-group">
                            <label>Etapa do ciclo de vida (Res√≠duos):</label>
                            <select name="etapa_ciclo_vida">
                                <option value="nao_aplica">N√£o se aplica</option>
                                <option value="residuos_galhos_folhas">Res√≠duos de galhos e folhas</option>
                                <option value="residuos_casca">Res√≠duos de casca</option>
                                <option value="residuo_serragem">Res√≠duo de serragem</option>
                            </select>
                        </div>
                    </div>
                    <hr>
                    <div class="form-row">
                        <div class="field-group">
                            <label class="required">Dist√¢ncia de transporte da biomassa at√© a f√°brica:</label>
                            <input type="number" name="distancia_transporte_biomassa" value="100" step="1" min="0" required>
                            <div class="help-text">km</div>
                        </div>
                        <div class="field-group">
                            <label class="required">Tipo de ve√≠culo usado no transporte:</label>
                            <select name="tipo_veiculo_transporte" required>
                                <option value="">Selecione...</option>
                                {% for veiculo in veiculos %}
                                <option value="{{ veiculo.id }}">{{ veiculo.nome }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="tab-industrial">
                <div class="form-section">
                    <h3>Dados do Sistema</h3>
                    
                    <div class="field-group">
                        <label>Existe co-gera√ß√£o de energia (aproveitamento da biomassa)?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="existe_cogeneration" value="Sim" data-show="campo-cogen"> Sim</label>
                            <label><input type="radio" name="existe_cogeneration" value="N√£o" checked data-hide="campo-cogen"> N√£o</label>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="field-group">
                            <label class="required">Quantidade de biomassa processada:</label>
                            <input type="number" name="quantidade_biomassa_processada_kg" value="12000000" step="1" min="0" required>
                            <div class="help-text">kg/ano (n√£o considerar biomassa usada na co-gera√ß√£o)</div>
                        </div>
                        
                        <div class="field-group" id="campo-cogen" style="display: none;">
                            <label>Qtd. biomassa consumida na co-gera√ß√£o:</label>
                            <input type="number" name="biomassa_cogeracao_kg" value="0" step="1" min="0">
                            <div class="help-text">kg/ano</div>
                        </div>
                    </div>
                    
                    <hr>
                    <h4>Energia - Eletricidade (kWh/ano)</h4>
                    <div class="form-row">
                        <div class="field-group">
                            <label>Rede - mix m√©dia voltagem:</label>
                            <input type="number" name="eletricidade_rede_media_kwh" value="0">
                        </div>
                        <div class="field-group">
                            <label>Rede - mix alta voltagem:</label>
                            <input type="number" name="eletricidade_rede_alta_kwh" value="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="field-group">
                            <label>Eletricidade - PCH:</label>
                            <input type="number" name="eletricidade_pch_kwh" value="0">
                        </div>
                        <div class="field-group">
                            <label>Eletricidade - Biomassa:</label>
                            <input type="number" name="eletricidade_biomassa_kwh" value="1846801">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="field-group">
                            <label>Eletricidade - E√≥lica:</label>
                            <input type="number" name="eletricidade_eolica_kwh" value="0">
                        </div>
                        <div class="field-group">
                            <label>Eletricidade - Solar:</label>
                            <input type="number" name="eletricidade_solar_kwh" value="0">
                        </div>
                    </div>

                    <hr>
                    <h4>Energia - Combust√≠vel</h4>
                    <div class="form-row">
                        <div class="field-group">
                            <label>Diesel (Litros/ano):</label>
                            <input type="number" name="diesel_consumo" value="24.40" step="0.01">
                        </div>
                        <div class="field-group">
                            <label>G√°s natural (Nm¬≥/ano):</label>
                            <input type="number" name="gas_natural_consumo" value="0">
                        </div>
                        <div class="field-group">
                            <label>GLP (kg/ano):</label>
                            <input type="number" name="glp_consumo" value="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="field-group">
                            <label>Gasolina A (Litros/ano):</label>
                            <input type="number" name="gasolina_a_consumo" value="0">
                        </div>
                        <div class="field-group">
                            <label>Etanol anidro (Litros/ano):</label>
                            <input type="number" name="etanol_anidro_consumo" value="0">
                        </div>
                        <div class="field-group">
                            <label>Etanol hidratado (Litros/ano):</label>
                            <input type="number" name="etanol_hidratado_consumo" value="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="field-group">
                            <label>Cavaco de madeira (kg/ano):</label>
                            <input type="number" name="cavaco_madeira_consumo" value="0">
                        </div>
                        <div class="field-group">
                            <label>Lenha (kg/ano):</label>
                            <input type="number" name="lenha_consumo" value="0">
                        </div>
                    </div>

                    <hr>
                    <h4>Insumos de Manufatura</h4>
                    <div class="form-row">
                        <div class="field-group">
                            <label>√Ågua (litros/ano):</label>
                            <input type="number" name="agua_litros" value="0">
                        </div>
                        <div class="field-group">
                            <label>√ìleo lubrificante (kg/ano):</label>
                            <input type="number" name="oleo_lubrificante_kg" value="0">
                        </div>
                        <div class="field-group">
                            <label>Areia de s√≠lica (kg/ano):</label>
                            <input type="number" name="areia_silica_kg" value="0">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="tab-distribuicao">
                <div class="form-section">
                    <h3>Mercado Dom√©stico</h3>
                    
                    <div class="field-group">
                        <label class="required">Quantidade de biomassa transportada no mercado dom√©stico:</label>
                        <input type="number" name="quantidade_biocombustivel_distribuicao_ton" value="12000" step="0.1" required>
                        <div class="help-text">toneladas</div>
                    </div>
                    
                    <div class="field-group">
                        <label class="required">Dist√¢ncia de transporte do produto final at√© o mercado consumidor dom√©stico:</label>
                        <input type="number" name="distancia_mercado_domestico_km" value="100" step="1" required>
                        <div class="help-text">km</div>
                    </div>

                    <div class="form-row">
                        <div class="field-group">
                            <label>Ferrovi√°rio (%):</label>
                            <input type="number" name="percentual_ferroviario" value="0" step="0.1" max="100">
                            <div class="help-text">Dist√¢ncia distribu√≠da exclusivamente por via ferrovi√°ria</div>
                        </div>
                        <div class="field-group">
                            <label>Hidrovi√°rio (%):</label>
                            <input type="number" name="percentual_hidroviario" value="0" step="0.1" max="100">
                            <div class="help-text">Dist√¢ncia distribu√≠da exclusivamente por via hidrovi√°ria</div>
                        </div>
                    </div>
                    
                    <div class="field-group">
                        <label>Tipo de ve√≠culo usado no transporte rodovi√°rio:</label>
                        <select name="tipo_veiculo_rodoviario">
                            {% for veiculo in veiculos %}
                            <option value="{{ veiculo.id }}">{{ veiculo.nome }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>Exporta√ß√£o</h3>
                    <div class="field-group">
                        <label>Quantidade de biocombust√≠vel s√≥lido exportado via container mar√≠timo:</label>
                        <input type="number" name="quantidade_exportada_ton" value="0" step="0.1">
                        <div class="help-text">tonelada(s)</div>
                    </div>

                    <div id="dados-exportacao-detalhe">
                        <div class="field-group">
                            <label>Dist√¢ncia da f√°brica ao porto hidrovi√°rio mais pr√≥ximo:</label>
                            <input type="number" name="distancia_fabrica_porto_km" value="410" step="1">
                            <div class="help-text">km (Consulta: gov.br)</div>
                        </div>

                        <div class="form-row">
                            <div class="field-group">
                                <label>Ferrovi√°rio at√© porto (%):</label>
                                <input type="number" name="percentual_ferroviario_porto" value="0" step="0.1" max="100">
                            </div>
                            <div class="field-group">
                                <label>Hidrovi√°rio at√© porto (%):</label>
                                <input type="number" name="percentual_hidroviario_porto" value="0" step="0.1" max="100">
                            </div>
                        </div>

                        <div class="field-group">
                            <label>Tipo de ve√≠culo usado no transporte rodovi√°rio at√© o porto:</label>
                            <select name="tipo_veiculo_porto">
                                {% for veiculo in veiculos %}
                                <option value="{{ veiculo.id }}">{{ veiculo.nome }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="field-group">
                            <label>Dist√¢ncia do porto hidrovi√°rio ao mercado consumidor final:</label>
                            <input type="number" name="distancia_porto_consumidor" value="10015.23" step="0.01">
                            <div class="help-text">km (Consulta: searates.com)</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="tab-config">
                <div class="form-section">
                    <h3>Configura√ß√£o (Resultados)</h3>
                    <p>Referente √† √°rea de resultados da planilha.</p>
                    
                    <div class="field-group">
                        <label class="required">Volume de Produ√ß√£o Eleg√≠vel (CBIOs):</label>
                        <input type="number" name="volume_producao_ton_cbios" value="12000" step="0.1" required>
                        <div class="help-text">Total de produto acabado eleg√≠vel para emiss√£o.</div>
                    </div>
                    
                    <div class="field-group">
                        <label class="required">Combust√≠vel F√≥ssil Substituto:</label>
                        <select name="combustivel_fossil_substituto">
                            <option value="media_ponderada">M√©dia Ponderada (Diesel/Gasolina/GNV)</option>
                            <option value="oleo_combustivel">√ìleo Combustivel Pesado</option>
                            <option value="coque_petroleo">Coque Petroleo</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn-outline" id="prevBtn" style="display: none;">‚Üê Voltar</button>
                <button type="button" class="btn-outline" id="nextBtn">Pr√≥ximo ‚Üí</button>
                <button type="submit" class="btn-primary" id="submitBtn" style="display: none;">Calcular</button>
            </div>
        </form>
    </div>
    
    <script>
        // L√≥gica de Abas
        const tabs = ['tab-geral', 'tab-agricola', 'tab-industrial', 'tab-distribuicao', 'tab-config'];
        let currentTab = 0;

        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', function() {
                setTab(this.getAttribute('data-tab'));
            });
        });

        document.getElementById('nextBtn').addEventListener('click', () => {
            if (currentTab < tabs.length - 1) setTab(tabs[currentTab + 1]);
        });
        
        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentTab > 0) setTab(tabs[currentTab - 1]);
        });

        function setTab(tabId) {
            currentTab = tabs.indexOf(tabId);
            document.querySelectorAll('.tab-button').forEach(b => b.classList.toggle('active', b.getAttribute('data-tab') === tabId));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.toggle('active', c.id === tabId));
            
            const progress = ((currentTab + 1) / tabs.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            
            document.getElementById('prevBtn').style.display = currentTab === 0 ? 'none' : 'inline-block';
            if (currentTab === tabs.length - 1) {
                document.getElementById('nextBtn').style.display = 'none';
                document.getElementById('submitBtn').style.display = 'inline-block';
            } else {
                document.getElementById('nextBtn').style.display = 'inline-block';
                document.getElementById('submitBtn').style.display = 'none';
            }
        }
        
        // Show/Hide L√≥gica
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                if(this.checked) {
                    if(this.dataset.show) document.getElementById(this.dataset.show).style.display = 'block';
                    if(this.dataset.hide) document.getElementById(this.dataset.hide).style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>