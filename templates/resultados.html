<!DOCTYPE html>
<html>
<head>
    <title>BioCalc - Resultados</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div class="header-logo">
            <h1>üìä Resultados da ACV</h1>
            <p>An√°lise de Ciclo de Vida do Biocombust√≠vel</p>
        </div>

        <div style="display: flex; gap: 20px; margin-bottom: 30px;">
            <div class="result-card" style="flex: 1; text-align: center;">
                <h3>Intensidade de Carbono</h3>
                <div style="font-size: 2.5em; color: #27ae60; font-weight: bold;">
                    {{ "%.2f"|format(resultados.intensidade_total_g_co2eq_mj) }}
                </div>
                <div style="color: #666;">gCO‚ÇÇeq / MJ</div>
            </div>

            <div class="result-card" style="flex: 1; text-align: center; border-left-color: #f39c12;">
                <h3>CBIOs Gerados</h3>
                <div style="font-size: 2.5em; color: #f39c12; font-weight: bold;">
                    {{ resultados.cbios }}
                </div>
                <div style="color: #666;">cr√©ditos estimados</div>
            </div>
            
            <div class="result-card" style="flex: 1; text-align: center; border-left-color: #2980b9;">
                <h3>Nota de Efici√™ncia</h3>
                <div style="font-size: 2.5em; color: #2980b9; font-weight: bold;">
                    {{ "%.2f"|format(resultados.nota_eficiencia) }}
                </div>
                <div style="color: #666;">gCO‚ÇÇeq / MJ (Redu√ß√£o)</div>
            </div>
        </div>

        <div style="display: flex; gap: 20px;">
            <div style="flex: 1;">
                <h3>Detalhamento por Fase</h3>
                <table>
                    <tr>
                        <th>Fase</th>
                        <th>Emiss√£o (gCO‚ÇÇeq/MJ)</th>
                    </tr>
                    <tr>
                        <td>üå± Agr√≠cola</td>
                        <td>{{ "%.4f"|format(resultados.detalhes.agricola) }}</td>
                    </tr>
                    <tr>
                        <td>üè≠ Industrial</td>
                        <td>{{ "%.4f"|format(resultados.detalhes.industrial) }}</td>
                    </tr>
                    <tr>
                        <td>üöö Transporte & Distribui√ß√£o</td>
                        <td>{{ "%.4f"|format(resultados.detalhes.transporte) }}</td>
                    </tr>
                    <tr>
                        <td>üî• Uso Final</td>
                        <td>{{ "%.4f"|format(resultados.detalhes.uso) }}</td>
                    </tr>
                </table>
                
                <div style="margin-top: 20px; padding: 15px; background: #eee; border-radius: 5px;">
                    <h4>Dados de Entrada:</h4>
                    <p><strong>Biomassa:</strong> {{ inputs.biomassa.replace('_', ' ').title() }}</p>
                    <p><strong>Produ√ß√£o:</strong> {{ inputs.volume_producao_ton_cbios }} ton/ano</p>
                    <p><strong>Dist. F√°brica:</strong> {{ inputs.distancia_transporte_biomassa }} km</p>
                    <p><strong>Dist. Cliente:</strong> {{ inputs.distancia_mercado_domestico_km }} km</p>
                </div>
            </div>

            <div style="flex: 1;">
                <canvas id="chartImpacto"></canvas>
            </div>
        </div>

        <div class="form-actions" style="margin-top: 30px;">
            <a href="/" class="btn-outline">‚Üê Novo C√°lculo</a>
            <a href="/historico" class="btn-primary">Ver Hist√≥rico</a>
        </div>
    </div>

<script>
        // Configura√ß√£o do Gr√°fico
        const ctx = document.getElementById('chartImpacto').getContext('2d');
        
        // TRUQUE PARA O EDITOR N√ÉO RECLAMAR:
        // Colocamos entre aspas "..." para o editor achar que √© texto
        // E usamos Number() para o JavaScript converter de volta para n√∫mero
        
        const valorFossil = Number("{{ resultados.fossil_ref | default(86.7) }}");
        const valorBio = Number("{{ resultados.intensidade_total_g_co2eq_mj }}");

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['F√≥ssil (Refer√™ncia)', 'Seu Biocombust√≠vel'],
                datasets: [{
                    label: 'Intensidade de Carbono (gCO‚ÇÇeq/MJ)',
                    data: [valorFossil, valorBio],
                    backgroundColor: ['#7f8c8d', '#27ae60'],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { 
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'gCO‚ÇÇeq / MJ'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'Comparativo de Emiss√µes'
                    }
                }
            }
        });
    </script>
</body>
</html>